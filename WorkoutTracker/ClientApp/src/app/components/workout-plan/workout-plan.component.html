<div>
    <div class="d-flex flex-row mb-2">
        <input
            #workoutPlanName
            (change)="updateWorkoutPlanName(workoutPlanName.value)"
            value="{{ workoutPlan.name }}"
            class="form-control mr-2"
        />
        <button
            [attr.aria-expanded]="!isCollapsed"
            (click)="isCollapsed = !isCollapsed"
            class="btn btn-dark mr-2"
            type="button"
            data-toggle="collapse"
            data-target="#workoutPlan"
            aria-controls="workoutPlan"
        >
            <svg
                *ngIf="isCollapsed"
                width="1em"
                height="1em"
                viewBox="0 0 16 16"
                class="bi bi-caret-down-fill"
                fill="currentColor"
                xmlns="http://www.w3.org/2000/svg">
                <path d="M7.247 11.14L2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z" />
            </svg>
            <svg
                *ngIf="!isCollapsed"
                width="1em"
                height="1em"
                viewBox="0 0 16 16"
                class="bi bi-caret-up-fill"
                fill="currentColor"
                xmlns="http://www.w3.org/2000/svg"
            >
                <path d="M7.247 4.86l-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z" />
            </svg>
        </button>
        <button (click)="deleteWorkoutPlan()" class="btn btn-dark text-nowrap">Delete workout plan</button>
    </div>
    <div
        [ngbCollapse]="isCollapsed"
        id="workoutPlan"
        class="collapse"
    >
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>Set #</th>
                    <th>Exercise</th>
                    <th>Rep Range</th>
                    <th>Rest Time (s)</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr
                    app-set-plan
                    *ngFor="let setPlan of setPlans"
                    [setPlan]="setPlan"
                    [exercises]="exercises"
                    (setPlanUpdateOrder)="updateSetPlanOrder($event.setPlanId, $event.order)"
                    (setPlanDelete)="deleteSetPlan($event)">
                </tr>
                <tr>
                    <td class="align-middle">
                        <div *ngIf="setPlans" class="pl-2">
                            {{ setPlans.length + 1 }}
                        </div>
                    </td>
                    <td>
                        <select #exerciseName [formControl]="newSetPlanExerciseName" class="form-control">
                            <option value="null" disabled selected> -- Exercise -- </option>
                            <option *ngFor="let exercise of exercises">
                                {{ exercise.name }}
                            </option>
                        </select>
                    </td>
                    <td>
                        <div class="align-items-center d-flex flex-row">
                            <input #repsTargetLow [formControl]="newSetPlanRepsTargetLow" class="form-control mr-2" placeholder="Rep Range Low" />
                            <span class="mr-2">
                                <b>-</b>
                            </span>
                            <input #repsTargetHigh [formControl]="newSetPlanRepsTargetHigh" class="form-control mr-2" placeholder="Rep Range High" />
                            <div class="form-check">
                                <input
                                    #toFailure
                                    (change)=toggleNewSetToFailure(toFailure.checked)
                                    [formControl]="newSetPlanToFailure"
                                    class="form-check-input"
                                    type="checkbox"
                                >
                                <label class="form-check-label text-nowrap">To Failure</label>
                            </div>
                        </div>
                    </td>
                    <td>
                        <input #restTime [formControl]="newSetPlanRestTime" class="form-control" placeholder="Rest Time" />
                    </td>
                    <td>
                        <button
                            (click)="addSetPlan(exerciseName.value, repsTargetLow.value, repsTargetHigh.value, toFailure.checked, restTime.value)"
                            class="btn btn-dark text-nowrap"
                        >
                            Add set
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
